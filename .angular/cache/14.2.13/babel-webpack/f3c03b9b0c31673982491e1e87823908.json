{"ast":null,"code":"import { __decorate, __metadata, __param } from \"tslib\";\nimport { Component, Inject } from '@angular/core';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { User } from 'app/shared/user/user.model';\nlet AddUserDialogComponent = class AddUserDialogComponent {\n  constructor(dialogRef, user, data) {\n    this.dialogRef = dialogRef;\n    this.user = user;\n    this.data = data;\n    this.user = new User(0, '', '', '', '');\n  }\n\n  onNoClick() {\n    this.dialogRef.close();\n  }\n\n  saveUser() {\n    if (this.user.name.trim() && this.user.email.trim()) {\n      // ✅ Vérifier si l'utilisateur existe AVANT d'envoyer le POST\n      this.userService.checkUserExists(this.user.email).subscribe({\n        next: exists => {\n          if (exists) {\n            alert(\"L'utilisateur avec cet email existe déjà !\");\n          } else {\n            // ✅ Si l'email n'existe pas, ajouter l'utilisateur\n            this.userService.addUser(this.user).subscribe({\n              next: response => {\n                console.log('Utilisateur ajouté avec succès:', response);\n                this.dialogRef.close(response); // ✅ Ferme le dialogue\n              },\n              error: err => {\n                console.error('Erreur lors de l\\'ajout:', err);\n                alert('Une erreur est survenue.');\n              }\n            });\n          }\n        },\n        error: err => {\n          console.error('Erreur lors de la vérification:', err);\n          alert(\"Erreur lors de la vérification de l'email.\");\n        }\n      });\n    } else {\n      alert('Nom et Email sont obligatoires');\n    }\n  }\n\n};\nAddUserDialogComponent = __decorate([Component({\n  selector: 'app-add-user-dialog',\n  templateUrl: './add-user-dialog.component.html',\n  styleUrls: ['./add-user-dialog.component.css']\n}), __param(2, Inject(MAT_DIALOG_DATA)), __metadata(\"design:paramtypes\", [MatDialogRef, Object, Object])], AddUserDialogComponent);\nexport { AddUserDialogComponent };","map":null,"metadata":{},"sourceType":"module"}